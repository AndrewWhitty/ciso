Massive tidy up.
Threading for compression (threading/Queue)
